{
  "active": false,
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Question and Answer Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Plan Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‚ÄòExecute workflow‚Äô": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set File ID": {
      "main": [
        [
          {
            "node": "Delete Old Doc Records",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Set File ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Postgres PGVector Store1",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Postgres PGVector Store1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Delete Old Doc Records": {
      "main": [
        [
          {
            "node": "Delete Old Data Records",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Old Data Records": {
      "main": [
        [
          {
            "node": "Insert Document Metadata",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert Document Metadata": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Ollama1": {
      "ai_embedding": [
        [
          {
            "node": "RAG b·ªánh vi·ªán",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model": {
      "ai_languageModel": [
        []
      ]
    },
    "Think": {
      "ai_tool": [
        [
          {
            "node": "Plan Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Search URL": {
      "ai_tool": [
        [
          {
            "node": "Search Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Plan Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Convert to JSON": {
      "main": [
        [
          {
            "node": "Convert to JSON1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Convert to JSON2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        []
      ]
    },
    "Convert to JSON1": {
      "main": [
        [
          {
            "node": "RAG Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RAG b·ªánh vi·ªán": {
      "ai_tool": [
        [
          {
            "node": "RAG Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RAG Agent": {
      "main": [
        [
          {
            "node": "Define RAG agent output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Plan Agent": {
      "main": [
        [
          {
            "node": "Convert to JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search Agent": {
      "main": [
        [
          {
            "node": "Define web agent output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to JSON2": {
      "main": [
        [
          {
            "node": "Search Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Define RAG agent output": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Define web agent output": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "fetch content": {
      "ai_tool": [
        [
          {
            "node": "Search Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "RAG Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Search Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Plan Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Question and Answer Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Vector Store Retriever": {
      "ai_retriever": [
        [
          {
            "node": "Question and Answer Chain",
            "type": "ai_retriever",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store": {
      "ai_vectorStore": [
        [
          {
            "node": "Vector Store Retriever",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere": {
      "ai_reranker": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Question and Answer Chain": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Character Text Splitter": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-26T04:44:20.033Z",
  "id": "p6edfRzQxNNKr6oK",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "RAG + Tool Search",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        1000,
        500
      ],
      "id": "7c0efe26-7f1c-45bd-b669-e477f1afea1e",
      "name": "When chat message received",
      "webhookId": "4beae4a8-825d-477f-8b23-676804c728ba"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6377c789-0ea6-4cda-8b12-9adcb4d5111d",
              "name": "chatInput",
              "value": "={{ $json?.chatInput || $json.body.chatInput }}",
              "type": "string"
            },
            {
              "id": "d722d392-01e7-48fb-9dea-266b557fe805",
              "name": "sessionId",
              "value": "={{ $json?.chatInput || $json.body.chatInput }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2464,
        570
      ],
      "id": "f1e58c88-a632-416d-ad59-5aca4f3c1c61",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "CREATE TABLE document_metadata (\n    id TEXT PRIMARY KEY,\n    title TEXT,\n    created_at TIMESTAMP DEFAULT NOW(),\n    schema TEXT\n);",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        -3240,
        2580
      ],
      "id": "f54d8e24-3859-4cc0-a4e0-b83dd6c01df1",
      "name": "Create Document Metadata Table",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "CREATE TABLE document_rows (\n    id SERIAL PRIMARY KEY,\n    dataset_id TEXT REFERENCES document_metadata(id),\n    row_data JSONB  -- Store the actual row data\n);",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        -3240,
        1400
      ],
      "id": "3374bac2-0d24-46c3-9844-3fdd3fedb6ae",
      "name": "Create Document Rows Table (for Tabular Data)",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -3240,
        1810
      ],
      "id": "efcbc485-6a09-4302-8269-77319302502b",
      "name": "When clicking ‚ÄòExecute workflow‚Äô"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
              "name": "file_id",
              "value": "={{ $json.fileName }}",
              "type": "string"
            },
            {
              "id": "f4536df5-d0b1-4392-bf17-b8137fb31a44",
              "name": "file_type",
              "value": "={{ $json.fileType.split(/[\\\\/]/).pop().split('.').pop(); }}",
              "type": "string"
            },
            {
              "id": "77d782de-169d-4a46-8a8e-a3831c04d90f",
              "name": "file_title",
              "value": "={{ $json.fileName.split(/[\\\\/]/).pop().split('.').slice(0, -1).join('.'); }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "a692dd97-ae45-413c-babd-56c9607d0805",
      "name": "Set File ID",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2580,
        1720
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -2800,
        1810
      ],
      "id": "ac35c509-39d8-439d-80e6-a7543f757815",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "fileSelector": "=/home/duckq1u/Documents/testing_rag/pct_info_md/output/*.md",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -3020,
        1810
      ],
      "id": "03fa0998-1077-4d75-84bb-d6565437ad72",
      "name": "Read/Write Files from Disk1"
    },
    {
      "parameters": {
        "jsonMode": "expressionData",
        "jsonData": "={{ $json.data }}",
        "textSplittingMode": "custom",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        -1112,
        2180
      ],
      "id": "45a6a039-d686-406b-b00b-d08b48171678",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "fileSelector": "=/home/duckq1u/Documents/testing_rag/pct_info_md/output/{{ $('Set File ID').item.json.file_id }}",
        "options": {
          "dataPropertyName": "=data"
        }
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -1700,
        1810
      ],
      "id": "75ebb53b-c035-4aa6-9afa-b22aeb8264cd",
      "name": "Read/Write Files from Disk"
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -1480,
        1810
      ],
      "id": "fb7f3673-86d8-45a8-a8b2-f9ca45d84dd1",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "DO $$\nBEGIN\n    IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'documents_pg') THEN\n        EXECUTE 'DELETE FROM documents_pg WHERE metadata->>''file_id'' LIKE ''%' || $1 || '%''';\n    END IF;\nEND\n$$;",
        "options": {
          "queryReplacement": "={{ $json.file_id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        -2360,
        1710
      ],
      "id": "bf3fd862-d6d0-41aa-a93e-47419b4fd959",
      "name": "Delete Old Doc Records",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "DELETE FROM document_rows\nWHERE dataset_id LIKE '%' || $1 || '%';",
        "options": {
          "queryReplacement": "={{ $('Set File ID').item.json.file_id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        -2140,
        1710
      ],
      "id": "9069ba72-9769-49d7-800c-edb7ddfb210f",
      "name": "Delete Old Data Records",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "content": "T·∫°o function cho pgvector",
        "height": 1747,
        "width": 253,
        "color": 5
      },
      "id": "6004dbde-7083-499a-bca9-5d318c2a73de",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3320,
        1060
      ]
    },
    {
      "parameters": {
        "content": "N·∫°p file",
        "height": 700,
        "width": 2900
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3462,
        1620
      ],
      "id": "8f982ffb-6051-4db6-81c7-e260bc380e19",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "upsert",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "value": "document_metadata",
          "mode": "list",
          "cachedResultName": "document_metadata"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id": "={{ $('Set File ID').item.json.file_id }}",
            "title": "={{ $('Set File ID').item.json.file_title }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": true,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "title",
              "displayName": "title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false
            },
            {
              "id": "url",
              "displayName": "url",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false,
              "removed": true
            },
            {
              "id": "created_at",
              "displayName": "created_at",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "canBeUsedToMatch": false
            },
            {
              "id": "schema",
              "displayName": "schema",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.5,
      "position": [
        -1920,
        1710
      ],
      "id": "7e0a3514-7444-4ac9-97a8-99de4e577125",
      "name": "Insert Document Metadata",
      "executeOnce": true,
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": "=documents_pg",
        "embeddingBatchSize": 1024,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        -1260,
        1960
      ],
      "id": "68634a14-98d4-4e3f-aff6-d66be7998a5a",
      "name": "Postgres PGVector Store1",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "-- Th√™m c·ªôt paragraph n·∫øu ch∆∞a t·ªìn t·∫°i (d√πng TEXT, kh√¥ng d√πng CHAR)\nALTER TABLE document_metadata \nADD COLUMN IF NOT EXISTS paragraph TEXT;\n\n-- C·∫≠p nh·∫≠t n·ªôi dung markdown v√†o d√≤ng c√≥ id = 'bao-lanh-vien-phi.md'\nUPDATE document_metadata \nSET paragraph = $${{ $json.data }}$$\nWHERE id = '{{ $json.id }}';\n",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -884,
        1660
      ],
      "id": "95be4aa9-0ab4-4179-9db0-725449b9f9bc",
      "name": "Execute a SQL query",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1182,
        1660
      ],
      "id": "ef9339c6-6613-497a-8ce3-81eefdac3811",
      "name": "Merge"
    },
    {
      "parameters": {
        "model": "bge-m3:567m"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [
        -1360,
        440
      ],
      "id": "4cd3d9cd-a91a-4e14-8052-5f77f3e805c4",
      "name": "Embeddings Ollama1",
      "credentials": {
        "ollamaApi": {
          "id": "wgDZ9FFIzY80c00J",
          "name": "Local Ollama"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "TRUNCATE TABLE documents_pg;\nTRUNCATE TABLE document_metadata, document_rows;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3240,
        2320
      ],
      "id": "74b3eb29-a394-46d4-8aea-b0f07337246a",
      "name": "Clean",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "model": "deepseek-r1-distill-llama-70b",
        "options": {
          "maxTokensToSample": 20678
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        -3240,
        1160
      ],
      "id": "dae38752-f712-409d-92bd-e676ce8a709b",
      "name": "Groq Chat Model",
      "credentials": {
        "groqApi": {
          "id": "XG6ZrBFEIJ1KtuOu",
          "name": "Groq account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        -2040,
        800
      ],
      "id": "c49ce34b-089e-4e42-877c-52067f7cf6c3",
      "name": "Think"
    },
    {
      "parameters": {
        "operation": "executeTool",
        "toolName": "kagi_search_fetch",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        -1040,
        980
      ],
      "id": "a3e39064-57ad-4934-96f5-9601f6fba6d6",
      "name": "Search URL",
      "credentials": {
        "mcpClientApi": {
          "id": "l7gNVLTzrA47Iigk",
          "name": "DuckDuckGo"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -2200,
        780
      ],
      "id": "c336ad00-86bf-42ce-bac1-9fb67977ad71",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={{ JSON.parse($json.output.replace(/<think>[\\s\\S]*?<\\/think>\\n*/g, \"\").replace(/```json\\n?/, \"\").replace(/```/, \"\")) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1900,
        420
      ],
      "id": "4265062c-615a-4586-9178-847ee33e25d6",
      "name": "Convert to JSON"
    },
    {
      "parameters": {
        "content": "# RAG",
        "height": 1200,
        "width": 2820,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2840,
        -40
      ],
      "typeVersion": 1,
      "id": "707b2dfb-4ea1-4c38-8601-624f5eda513d",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -660,
        460
      ],
      "id": "49700658-7be3-4aab-b562-1dd030381762",
      "name": "Merge1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"output\": {\n    \"user_question_analysis\": {{ $json.user_question_analysis.removeField('intent') }},\n    \"task_plan\": {{ $json.task_plan.rag_agent }}\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1760,
        80
      ],
      "id": "8a6896f5-a3ab-437f-9e8c-15f66a09d97b",
      "name": "Convert to JSON1"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "ƒë∆∞·ª£c S·ª≠ d·ª•ng ƒë·ªÉ l·∫•y ki·∫øn th·ª©c t·ª´ kho th√¥ng tin b·ªánh vi·ªán",
        "tableName": "documents_pg",
        "topK": 10,
        "includeDocumentMetadata": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        -1420,
        260
      ],
      "id": "5b338568-f95a-46e5-b08b-9e32ad3bab55",
      "name": "RAG b·ªánh vi·ªán",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.output.task_plan.objective }} v·ªÅ nh·ªØng ƒë·ªëi t∆∞·ª£ng sau {{ $json.output.user_question_analysis.key_entities }}",
        "options": {
          "systemMessage": "=B·∫°n l√† m·ªôt Agent th√¥ng minh s·ª≠ d·ª•ng k·ªπ thu·∫≠t **ReAct (Reason + Act)** ƒë·ªÉ truy v·∫•n d·ªØ li·ªáu n·ªôi b·ªô th√¥ng qua **RAG (Retrieval-Augmented Generation)**.\n\nƒë·∫ßu v√†o c·ªßa b·∫°n: \n```Json\n{{ $json.output }}\n```\n## M·ª•c ti√™u:\n-Ph√¢n t√≠ch m·ª•c ti√™u ({{ $json.output.user_question_analysis.key_entities }}) v√† ng·ªØ c·∫£nh ({{ $json.output.user_question_analysis.type }}).\n-{{ $json.output.task_plan.objective }}.\n-ƒê·∫£m b·∫£o ƒë·∫ßu ra ph·∫£i ƒë·∫ßy ƒë·ªß th√¥ng tin nh∆∞ {{ $json.output.task_plan.input_focus }}... etc\n-Suy lu·∫≠n theo t·ª´ng b∆∞·ªõc logic ƒë·ªÉ x√°c ƒë·ªãnh n√™n truy v·∫•n g√¨.\n-G·ªçi h√†nh ƒë·ªông truy v·∫•n d·ªØ li·ªáu n·ªôi b·ªô (RAG retrieval) t∆∞∆°ng ·ª©ng.\n-T·ªïng h·ª£p c√¢u tr·∫£ l·ªùi d·ª±a tr√™n th√¥ng tin ƒë√£ truy xu·∫•t.\n\nQuy tr√¨nh ReAct (√°p d·ª•ng m·ªói v√≤ng l·∫∑p):\n```text\nThought: <b·∫°n suy nghƒ© g√¨, v√≠ d·ª•: T√¥i c·∫ßn t√¨m hi·ªÉu c√°c m√¥ h√¨nh AI li√™n quan ƒë·∫øn gi√°o d·ª•c ƒë·∫°i h·ªçc>\nAction: RAG.retrieve[\"<truy v·∫•n c·ª• th·ªÉ c·∫ßn t√¨m>\"]\nObservation: <k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ d·ªØ li·ªáu n·ªôi b·ªô>\n... (l·∫∑p l·∫°i n·∫øu c·∫ßn)\nFinal Answer: <c√¢u tr·∫£ l·ªùi ho√†n ch·ªânh d·ª±a tr√™n t·∫•t c·∫£ c√°c observation>\n```\n\nQuy t·∫Øc:\n-Kh√¥ng b·ªãa th√¥ng tin n·∫øu k·∫øt qu·∫£ truy v·∫•n kh√¥ng ƒë·∫ßy ƒë·ªß. Thay v√†o ƒë√≥, ghi ch√∫ r√µ \"Ch∆∞a ƒë·ªß th√¥ng tin t·ª´ ngu·ªìn n·ªôi b·ªô\".\n-Kh√¥ng g·ªçi Web Search Tool ‚Äì b·∫°n ch·ªâ d√πng d·ªØ li·ªáu n·ªôi b·ªô.\n-C√≥ th·ªÉ g·ªçi RAG nhi·ªÅu l·∫ßn n·∫øu c·∫ßn truy v·∫•n t·ª´ng ph·∫ßn.\n\nB·∫°n s·∫Ω b·∫Øt ƒë·∫ßu th·∫ø n√†y:\nThought: T√¥i c·∫ßn x√°c ƒë·ªãnh c√°c th√¥ng tin v·ªÅ {{ $json.output.task_plan.input_focus }}.\nAction: RAG.retrieve[{{ $json.output.user_question_analysis.key_entities }}].\nObservation: deepseek ƒë∆∞·ª£c d√πng ƒë·ªÉ t·ªïng h·ª£p th√¥ng tin.\nThought: T√¥i c·∫ßn l·∫•y th√™m nhi·ªÅu th√¥ng tin h∆°n.\nAction: Li·ªát k√™ FILE hi·ªán c√≥\nObservation: qwen ƒë∆∞·ª£c d√πng ƒë·ªÉ ƒë√°nh gi√° c·∫£ nh·ªØng FILE n√†o c√≥ li√™n quan ƒë·∫øn c√°c entities trong input.\nThought: T√¥i c·∫ßn th√¥ng tin chi ti·∫øt t·ª´ vƒÉn b·∫£n c√≥ t√™n FILE ƒë∆∞·ª£c qwen cho l√† li√™n quan\nAction: L·∫•y vƒÉn b·∫£n ho√†n ch·ªânh t·ª´ nh·ªØng FILE ƒë√£ ƒë∆∞·ª£c qwen cho l√† li√™n quan.\nObservation: T√¥i ch·ªâ c·∫ßn t√≥m t·∫Øt nh·ªØng vƒÉn b·∫£n ƒë√≥ ch·ª© kh√¥ng c·∫ßn ph√¢n t√≠ch.\nFinal Answer: m√¥ h√¨nh qwen ƒë∆∞∆°c d√πng ƒë·ªÉ t·ªïng h·ª£p t·∫•t c·∫£ th√¥ng tin.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -1500,
        40
      ],
      "id": "05e83e2e-1515-4d08-a7f9-8ce1612e8597",
      "name": "RAG Agent"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=B·∫°n l√† m·ªôt Agent l·∫≠p k·∫ø ho·∫°ch th√¥ng minh, ch·ªãu tr√°ch nhi·ªám ti·∫øp nh·∫≠n c√¢u h·ªèi c·ªßa ng∆∞·ªùi d√πng, sau ƒë√≥:\n1. ƒê·ªçc c√¢u h·ªèi c·ªßa ng∆∞·ªùi d√πng m·ªôt c√°ch t·ª± nhi√™n v√† ph√¢n t√≠ch th·∫≠t chi ti·∫øt:\n   - √ù ƒë·ªãnh c·ªßa ng∆∞·ªùi d√πng (intent)\n   - C√°c th·ª±c th·ªÉ ch√≠nh (key entities)\n   - Lo·∫°i c√¢u h·ªèi (type): tra c·ª©u, ph√¢n t√≠ch, t·ªïng h·ª£p, so s√°nh, v.v.\n2. Sau khi ph√¢n t√≠ch, b·∫°n s·ª≠ d·ª•ng **tool `think`** ƒë·ªÉ:\n  2.1.M·ªôt Agent s·ª≠ d·ª•ng RAG (Retrieval-Augmented Generation) ƒë·ªÉ ph√¢n t√≠ch d·ª±a tr√™n c∆° s·ªü d·ªØ li·ªáu n·ªôi b·ªô.\n  2.2.M·ªôt Agent s·ª≠ d·ª•ng Web Search Tool ƒë·ªÉ t√¨m ki·∫øm th√¥ng tin c·∫≠p nh·∫≠t t·ª´ Internet.\n  2.3.C·∫•u tr√∫c ƒë·∫ßu ra b·∫°n ph·∫£i tu√¢n th·ªß:\n  ```json\n  {\n    \"user_question_analysis\": {\n      \"intent\": \"<M√¥ t·∫£ m·ª•c ƒë√≠ch c·ªßa c√¢u h·ªèi>\",\n      \"key_entities\": [\"<thu·∫≠t ng·ªØ/nh√¢n v·∫≠t/s·ª± ki·ªán ch√≠nh>\"],\n      \"type\": \"<Lo·∫°i c√¢u h·ªèi: tra c·ª©u, ph√¢n t√≠ch, so s√°nh, t·ªïng h·ª£p...>\"\n    },\n    \"task_plan\": {\n      \"rag_agent\": {\n        \"objective\": \"<Agent RAG c·∫ßn l√†m g√¨>\",\n        \"input_focus\": \"<T·∫≠p trung v√†o ph·∫ßn n√†o c·ªßa c√¢u h·ªèi, d√πng d·ªØ li·ªáu n√†o n·∫øu c√≥>\"\n      },\n      \"web_search_agent\": {\n        \"objective\": \"<Agent Web Search c·∫ßn l√†m g√¨>\",\n        \"search_strategy\": \"<G·ª£i √Ω t·ª´ kh√≥a, ngu·ªìn c·∫ßn t√¨m, ph·∫°m vi>\"\n      }\n    }\n  }\n  ```\nNguy√™n t·∫Øc ho·∫°t ƒë·ªông:\n-Kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp c√¢u h·ªèi ng∆∞·ªùi d√πng.\n-Ch·ªâ ph√¢n t√≠ch v√† l·∫≠p k·∫ø ho·∫°ch.\n-N·∫øu c√¢u h·ªèi qu√° chung ho·∫∑c m∆° h·ªì, h√£y y√™u c·∫ßu l√†m r√µ.\n-B·∫°n KH√îNG ƒë∆∞·ª£c tr·∫£ l·ªùi c√¢u h·ªèi g·ªëc c·ªßa ng∆∞·ªùi d√πng.  \n-Ch·ªâ ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng tool `think` ƒë·ªÉ m√¥ t·∫£ r√µ nhi·ªám v·ª• c·ªßa t·ª´ng Agent con.\n-Nh·ªØng c√° nh√¢n ho·∫∑c t·∫≠p th·ªÉ m∆° h·ªì ƒë∆∞·ª£c ƒë·ªÅ c·∫≠p trong c·∫©u h·ªèi \"{{ $json.chatInput }}\" ƒë·ªÅu c√≥ ch·ªß th·ªÉ l√† \"b·ªánh vi·ªán y Phan Ch√¢u Trinh\"\n\nV√≠ d·ª•:\nC√¢u h·ªèi ng∆∞·ªùi d√πng: \"AI n√†o hi·ªán nay m·∫°nh nh·∫•t cho t√°c v·ª• vi·∫øt b√°o c√°o k·ªπ thu·∫≠t v√† c√≥ th·ªÉ d√πng n·ªôi b·ªô doanh nghi·ªáp?\"\n```json\n{\n  \"user_question_analysis\": {\n    \"intent\": \"T√¨m hi·ªÉu m√¥ h√¨nh AI t·ªët nh·∫•t ƒë·ªÉ vi·∫øt b√°o c√°o k·ªπ thu·∫≠t, d√πng trong doanh nghi·ªáp\",\n    \"key_entities\": [\"AI\", \"vi·∫øt b√°o c√°o k·ªπ thu·∫≠t\", \"doanh nghi·ªáp\"],\n    \"type\": \"tra c·ª©u, ƒë√°nh gi√°\"\n  },\n  \"task_plan\": {\n    \"rag_agent\": {\n      \"objective\": \"Ph√¢n t√≠ch c√°c m√¥ h√¨nh AI ƒë√£ ƒë∆∞·ª£c l∆∞u tr·ªØ n·ªôi b·ªô, ƒë√°nh gi√° kh·∫£ nƒÉng vi·∫øt b√°o c√°o k·ªπ thu·∫≠t\",\n      \"input_focus\": \"Th√¥ng tin t·ª´ t√†i li·ªáu n·ªôi b·ªô v·ªÅ m√¥ h√¨nh AI v√† use case vi·∫øt b√°o c√°o\"\n    },\n    \"web_search_agent\": {\n      \"objective\": \"T√¨m c√°c m√¥ h√¨nh AI m·ªõi nh·∫•t (t√≠nh ƒë·∫øn th·ªùi ƒëi·ªÉm hi·ªán t·∫°i) d√πng t·ªët cho vi·∫øt b√°o c√°o k·ªπ thu·∫≠t\",\n      \"search_strategy\": \"T√¨m tr√™n c√°c ngu·ªìn nh∆∞ OpenAI, HuggingFace, Google Cloud AI, d√πng t·ª´ kh√≥a: 'best AI for technical report writing enterprise 2025'\"\n    }\n  }\n}\n```"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -2240,
        580
      ],
      "id": "c553ff1a-3b4a-4dfd-912e-f22995de89ac",
      "name": "Plan Agent"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Tr√≠ch xu·∫•t th√¥ng tin t·ª´ web \"https://pctuhealthcare.com/\" ",
        "options": {
          "systemMessage": "=B·∫°n l√† m·ªôt Agent chuy√™n t√¨m ki·∫øm th√¥ng tin m·ªõi nh·∫•t tr√™n Internet v√† s·ª≠ d·ª•ng ReAct.  \nNhi·ªám v·ª• c·ªßa b·∫°n l√† th·ª±c hi·ªán Web Search m·ªôt c√°ch c√≥ chi·∫øn l∆∞·ª£c, d·ª±a tr√™n ƒë·∫ßu v√†o sau:\n\n## üéØ Nhi·ªám v·ª• c·ªßa b·∫°n:\n1.Hi·ªÉu r√µ m·ª•c ti√™u (objective) ƒë·ªÉ kh√¥ng t√¨m lan man.\n2.S·ª≠ d·ª•ng c√°c key_entities ƒë·ªÉ t·∫°o t·ª´ kh√≥a t√¨m ki·∫øm ch·∫•t l∆∞·ª£ng cao.\n3.√Åp d·ª•ng search_strategy n·∫øu c√≥: t·ª´ kh√≥a\n4.Th·ª±c hi·ªán t√¨m ki·∫øm tr√™n Web b·∫±ng Tool: search \"DuckDuckGo\"\n5.T·ªïng h·ª£p th√¥ng tin ng·∫Øn g·ªçn, ch√≠nh x√°c v√† c√≥ d·∫´n ngu·ªìn n·∫øu c·∫ßn.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -1400,
        820
      ],
      "id": "17b1f5fe-5dd7-4127-b605-a1fb5edaa5dc",
      "name": "Search Agent"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"output\": {\n    \"user_question_analysis\": {{ $json.user_question_analysis.removeField('intent') }},\n    \"task_plan\": {{ $json.task_plan.web_search_agent }}\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1640,
        800
      ],
      "id": "a47017ab-732a-43d8-b3b2-510ed69fe235",
      "name": "Convert to JSON2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7f137d51-bffa-44ef-baf8-4c6c9472faf7",
              "name": "=Rag_agent",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1060,
        380
      ],
      "id": "161905be-2b98-4d0b-889a-c13648e28db9",
      "name": "Define RAG agent output"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7f137d51-bffa-44ef-baf8-4c6c9472faf7",
              "name": "Web_agent",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1020,
        620
      ],
      "id": "c1e59fc9-ea1c-412a-a002-11d39d4d9e26",
      "name": "Define web agent output"
    },
    {
      "parameters": {
        "operation": "executeTool",
        "toolName": "kagi_summarizer",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        -1140,
        1040
      ],
      "id": "bbdb96db-1106-4ab0-8cde-65e5a88490b3",
      "name": "fetch content",
      "credentials": {
        "mcpClientApi": {
          "id": "l7gNVLTzrA47Iigk",
          "name": "DuckDuckGo"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -1540,
        460
      ],
      "id": "fafa0a82-c497-4b23-ad48-3f70595d45fc",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "FChSbaOkIE7faxmX",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "model": "deepseek-r1-distill-llama-70b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        -2340,
        760
      ],
      "id": "643e9c14-9667-40e6-ae7d-7d9d6901a1e2",
      "name": "Groq Chat Model1",
      "credentials": {
        "groqApi": {
          "id": "qNZe6TNrpoeu9Iwp",
          "name": "Groq account 3"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "systemPromptTemplate": "=# Vai tr√≤\nB·∫°n chuy√™n truy xu·∫•t th√¥ng tin v·ªÅ B·ªánh vi·ªán \"ƒê·∫°i h·ªçc Y Phan Ch√¢u Trinh\".\n\n# M·∫∑c ƒë·ªãnh hi·ªÉu\n- M·∫∑c ƒë·ªãnh hi·ªÉu r·∫±ng m·ªçi c√¢u h·ªèi li√™n quan ƒë·∫øn ‚Äúb·ªánh vi·ªán‚Äù ho·∫∑c c√°c th√†nh ph·∫ßn nh∆∞ ‚Äúd·ªãch v·ª•‚Äù, ‚Äúgi·ªù l√†m vi·ªác‚Äù, ‚Äúb√°c sƒ©‚Äù, ‚Äúkhoa‚Äù, v.v. ƒë·ªÅu ƒëang n√≥i v·ªÅ **B·ªánh vi·ªán ƒê·∫°i h·ªçc Y Phan Ch√¢u Trinh**, tr·ª´ khi **ng∆∞·ªùi d√πng nh·∫Øc r√µ m·ªôt b·ªánh vi·ªán kh√°c**.\n\n# Quy t·∫Øc quan tr·ªçng:\n- **Lu√¥n lu√¥n truy v·∫•n d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ l·ªùi**, b·∫•t k·ªÉ c√¢u h·ªèi c√≥ ƒë∆°n gi·∫£n ƒë·∫øn ƒë√¢u.\n- **Lu√¥n lu√¥n ph·∫£n h·ªìi b·∫±ng th√¥ng tin ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª´ d·ªØ li·ªáu h·ªá th·ªëng.**\n- **Kh√¥ng ƒë∆∞·ª£c b·ªãa ra th√¥ng tin** n·∫øu kh√¥ng t·ªìn t·∫°i trong d·ªØ li·ªáu.\n\n## Nhi·ªám v·ª• c·ªßa b·∫°n:\n- Ph√¢n lo·∫°i c√¢u h·ªèi v√†o m·ªôt trong c√°c nh√≥m sau:\n  - **Th√¥ng tin chung**\n  - **D·ªãch v·ª•**\n  - **S·ª± ki·ªán**\n  - **Khoa**\n  - **B√°c sƒ©**\n  - **Tuy·ªÉn d·ª•ng**\n  - **Chi ph√≠ & B·∫£o hi·ªÉm**\n- D·ª±a tr√™n ph√¢n th√¥ng tin ƒë√£ tr√≠ch xu·∫•t v√† c√¢u h·ªèi ng∆∞·ªùi d√πng, tr·∫£ l·ªùi c√¢u h·ªèi\n- ƒê·ªëi v·ªõi c√°c c√¢u h·ªèi mang t√≠nh ch·∫•t li·ªát k√™, h√£y li·ªát k√™ ng·∫Øn g·ªçn v√† ƒë·∫ßy ƒë·ªß d·ª±a tr√™n th√¥ng tin ƒë√£ tr√≠ch xu·∫•t\n- N·∫øu **kh√¥ng t√¨m th·∫•y th√¥ng tin**, h√£y tr·∫£ l·ªùi r·∫±ng **\"T√¥i kh√¥ng t√¨m th·∫•y th√¥ng tin li√™n quan trong h·ªá th·ªëng.\"**\n- N·∫øu **c√¢u h·ªèi m∆° h·ªì ho·∫∑c ch∆∞a ƒë·ªß r√µ**, h√£y y√™u c·∫ßu ng∆∞·ªùi d√πng l√†m r√µ.\n\n## ƒê·ªãnh d·∫°ng ph·∫£n h·ªìi:\n- Ng√¥n ng·ªØ: **Ti·∫øng Vi·ªát**\n- Tr√¨nh b√†y d·ªÖ ƒë·ªçc, c√≥ xu·ªëng d√≤ng c·∫ßn thi·∫øt.\n- Ph·∫£n h·ªìi ph·∫£i ƒë√∫ng theo ƒë·ªãnh d·∫°ng:\n  - Lo·∫°i c√¢u h·ªèi: [T√™n nh√≥m ch·ªß ƒë·ªÅ/ kh√¥ng x√°c ƒë·ªãnh]\n  - Ph·∫£n h·ªìi: [C√¢u tr·∫£ l·ªùi c·ª• th·ªÉ, r√µ r√†ng/ y√™u c·∫ßu l√†m r√µ/ kh√¥ng c√≥ trong d·ªØ li·ªáu] \n----------------\nContext: {context}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
      "typeVersion": 1.6,
      "position": [
        1300,
        500
      ],
      "id": "85d9c1dc-ebec-48a1-aaa6-86fe3abaecb2",
      "name": "Question and Answer Chain"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash",
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1160,
        760
      ],
      "id": "93b7321f-6624-482d-852a-3a186b0073f1",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "7fhytiSkpwvm2Ghp",
          "name": "Google Gemini(PaLM) Api account 4"
        }
      }
    },
    {
      "parameters": {
        "topK": 20
      },
      "type": "@n8n/n8n-nodes-langchain.retrieverVectorStore",
      "typeVersion": 1,
      "position": [
        1440,
        720
      ],
      "id": "86d37e60-9ad1-41f9-ad59-ce8c66ce5687",
      "name": "Vector Store Retriever"
    },
    {
      "parameters": {
        "tableName": "documents_pg",
        "useReranker": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        1440,
        900
      ],
      "id": "ee50c0ba-f42a-465d-a4c1-88d51aff36dd",
      "name": "Postgres PGVector Store",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        1700,
        1080
      ],
      "id": "5a8f7a21-63b4-48f0-af69-47c92e074f10",
      "name": "Reranker Cohere",
      "credentials": {
        "cohereApi": {
          "id": "BKc9JkfZm834Rmid",
          "name": "CohereApi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "eb98e14a-0e4e-4b89-92b9-cf512f8165fb",
              "name": "output",
              "value": "={{ $json.response }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1660,
        500
      ],
      "id": "bd3b9637-0539-4cb5-a686-7b2e563af99d",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1500,
        1120
      ],
      "id": "4f8f95af-c145-446e-96c1-476492c98b55",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "dimaJCF43ITM5WoO",
          "name": "OpenAi account 3"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        -1220,
        2180
      ],
      "id": "0447ef42-923b-401a-a829-03f4e4111a7e",
      "name": "Embeddings OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "dimaJCF43ITM5WoO",
          "name": "OpenAi account 3"
        }
      }
    },
    {
      "parameters": {
        "chunkOverlap": 200
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        -1020,
        2400
      ],
      "id": "475a63ec-e1b2-4b9d-bf7d-f70c0462d3c3",
      "name": "Character Text Splitter"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-07-07T06:15:01.000Z",
  "versionId": "f8e17ab3-e304-4f1a-a107-2ea4c1588b83"
}