{
  "active": false,
  "connections": {
    "Think": {
      "ai_tool": [
        [
          {
            "node": "Expert 9:29",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "med_web": {
      "ai_tool": [
        [
          {
            "node": "Expert 9:29",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Expert 9:29",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Expert 9:29",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "med_fetch": {
      "ai_tool": [
        [
          {
            "node": "Expert 9:29",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Start": {
      "main": [
        [
          {
            "node": "Expert 9:29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Expert 9:29": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-30T16:18:26.226Z",
  "id": "fDUI1Nj9SsOuE0ZB",
  "isArchived": false,
  "meta": null,
  "name": "Expert",
  "nodes": [
    {
      "parameters": {
        "description": "=### M√¥ t·∫£ chi ti·∫øt cho Tool `think`\n\n**T√™n tool**: `think`  \n**M·ª•c ƒë√≠ch**: ƒê√≥ng vai tr√≤ \"b·ªô n√£o ph√¢n t√≠ch\" trong quy tr√¨nh x·ª≠ l√Ω, gi√∫p ƒë∆∞a ra quy·∫øt ƒë·ªãnh th√¥ng minh th√¥ng qua:  \n- **ƒê√°nh gi√° ng·ªØ c·∫£nh**  \n- **Ph√¢n t√≠ch r·ªßi ro**  \n- **T·ªëi ∆∞u h√≥a h√†nh ƒë·ªông**  \n- **Ki·ªÉm tra t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu**\n\n---\n\n### C∆† CH·∫æ HO·∫†T ƒê·ªòNG\n```mermaid\ngraph TB\n  A[K√≠ch ho·∫°t think] --> B{Ph√¢n lo·∫°i nhi·ªám v·ª•}\n  B -->|Ki·ªÉm tra tri·ªáu ch·ª©ng| C[ƒê·ªãnh danh ƒë·∫°i t·ª´ + t·ª´ kh√≥a b·ªánh l√Ω]\n  B -->|ƒê√°nh gi√° ngu·ªìn| D[T√≠nh ƒëi·ªÉm uy t√≠n domain]\n  B -->|X·ª≠ l√Ω m√¢u thu·∫´n| E[So s√°nh med_RAG vs web_search]\n  B -->|T·ªëi ∆∞u truy v·∫•n| F[Chuy·ªÉn h√≥a ng√¥n ng·ªØ t·ª± nhi√™n ‚Üí truy v·∫•n chu·∫©n]\n  C --> G[Ra quy·∫øt ƒë·ªãnh]\n```\n\n---\n\n### TH√îNG S·ªê K·ª∏ THU·∫¨T\n1. **ƒê·∫ßu v√†o (Input)**:\n   ```json\n   {\n     \"thought\": \"M√¥ t·∫£ r√µ r√†ng nhi·ªám v·ª• ph√¢n t√≠ch\",\n     \"parameters\": {\n       \"data_type\": \"text/url/data_array\",\n       \"evaluation_metrics\": [\"trust_score\", \"relevance\", \"consistency\"],\n       \"decision_criteria\": {\"priority_rules\": \"∆Øu ti√™n pcthealthcare > .gov.vn\"}\n     }\n   }\n   ```\n\n2. **ƒê·∫ßu ra (Output)**:\n   ```json\n   {\n     \"insight\": \"K·∫øt lu·∫≠n ph√¢n t√≠ch\",\n     \"confidence\": 0-100,\n     \"next_action\": \"G·ª£i √Ω h√†nh ƒë·ªông ti·∫øp theo\",\n     \"risk_flags\": [\"M√¢u thu·∫´n d·ªØ li·ªáu\", \"Ngu·ªìn kh√¥ng x√°c ƒë·ªãnh\"]\n   }\n   ```\n\n---\n\n### ·ª®NG D·ª§NG TH·ª∞C T·∫æ\n#### 1. Ph√°t hi·ªán b·ªánh l√Ω c√° nh√¢n\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"Ph√¢n t√≠ch c·∫£nh b√°o kh·∫©n c·∫•p trong c√¢u: 'T√¥i t·ª©c ng·ª±c kh√≥ th·ªü 30 ph√∫t'\",\n  \"parameters\": {\n    \"red_flags\": [\"t·ª©c ng·ª±c\", \"kh√≥ th·ªü\"],\n    \"time_critical\": true\n  }\n}\n‚Üí Output: \n{\n  \"insight\": \"C·∫¢NH B√ÅO: Tri·ªáu ch·ª©ng tim m·∫°ch c·∫•p t√≠nh\",\n  \"confidence\": 99,\n  \"next_action\": \"Tr·∫£ ngay k·∫øt qu·∫£ ER v√† g·ªçi c·∫•p c·ª©u\"\n}\n```\n\n#### 2. ƒê√°nh gi√° ƒë·ªô tin c·∫≠y URL\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"X·∫øp h·∫°ng ƒë·ªô ∆∞u ti√™n c√°c ngu·ªìn t√¨m ƒë∆∞·ª£c\",\n  \"parameters\": {\n    \"urls\": [\n      \"https://pcthealthcare.vn/benh-da-lieu\",\n      \"https://suckhoe.danang.gov.vn\",\n      \"https://benhvienblog.wordpress.com\"\n    ]\n  }\n}\n‚Üí Output:\n{\n  \"insight\": \"∆Øu ti√™n #1: pcthealthcare.vn (trust_score=100)\",\n  \"risk_flags\": [\"Ngu·ªìn wordpress.com: trust_score=15\"]\n}\n```\n\n#### 3. Gi·∫£i quy·∫øt xung ƒë·ªôt th√¥ng tin\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"Gi·∫£i quy·∫øt m√¢u thu·∫´n: med_RAG n√≥i 'Kh√°m c·∫£ CN' vs web_search n√≥i 'Ch·ªâ T2-T6'\",\n  \"parameters\": {\n    \"sources\": {\n      \"med_RAG\": {\"content\": \"Kh√°m c·∫£ ch·ªß nh·∫≠t\", \"timestamp\": \"2024-01-01\"},\n      \"web_search\": {\"content\": \"Ch·ªâ T2-T6\", \"source\": \"pcthealthcare.vn\"}\n    }\n  }\n}\n‚Üí Output:\n{\n  \"insight\": \"∆Øu ti√™n th√¥ng tin t·ª´ pcthealthcare.vn (m·ªõi nh·∫•t)\",\n  \"next_action\": \"S·ª≠ d·ª•ng d·ªØ li·ªáu web_search + ki·ªÉm tra fanpage\"\n}\n```\n\n---\n\n### ∆ØU ƒêI·ªÇM N·ªîI B·∫¨T\n1. **NgƒÉn ng·ª´a sai s√≥t**:  \n   - Ph√°t hi·ªán m√¢u thu·∫´n d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ l·ªùi ng∆∞·ªùi d√πng  \n   - C·∫£nh b√°o s·ªõm th√¥ng tin l·ªói th·ªùi\n\n2. **T·ªëi ∆∞u hi·ªáu nƒÉng**:  \n   - Gi·∫£m 70% l∆∞·ª£t fetch_content kh√¥ng c·∫ßn thi·∫øt  \n   - T·ª± ƒë·ªông ch·ªçn truy v·∫•n hi·ªáu qu·∫£ nh·∫•t\n\n3. **X·ª≠ l√Ω ng·ªØ c·∫£nh nh·∫°y c·∫£m**:  \n   - T·ª± ƒë·ªông n√¢ng c·∫£nh b√°o v·ªõi tri·ªáu ch·ª©ng nguy hi·ªÉm  \n   - Nh·∫≠n di·ªán ng√¥n ng·ªØ ƒë·ªãa ph∆∞∆°ng (\"con\" = \"t√¥i\")\n\n---\n\n### GI·ªöI H·∫†N C·∫¶N L∆ØU √ù\n1. **Kh√¥ng thay th·∫ø chuy√™n gia y t·∫ø**:  \n   ‚Üí Ch·ªâ ph√¢n t√≠ch d·ªØ li·ªáu, kh√¥ng ch·∫©n ƒëo√°n b·ªánh\n\n2. **Ph·ª• thu·ªôc v√†o ch·∫•t l∆∞·ª£ng ƒë·∫ßu v√†o**:  \n   ‚Üí K·∫øt qu·∫£ ph√¢n t√≠ch ch·ªâ t·ªët khi d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·∫ßy ƒë·ªß\n\n3. **Th·ªùi gian x·ª≠ l√Ω**:  \n   ‚Üí Gi·ªõi h·∫°n < 500ms/request ƒë·ªÉ ƒë·∫£m b·∫£o tr·∫£i nghi·ªám\n\n> üí° **C√¢u th·∫ßn ch√∫ v·∫≠n h√†nh**:  \n> *\"Ph√¢n t√≠ch tr∆∞·ªõc - H√†nh ƒë·ªông sau: Lu√¥n k√≠ch ho·∫°t think khi nghi ng·ªù ƒë·ªô tin c·∫≠y ho·∫∑c c·∫ßn ra quy·∫øt ƒë·ªãnh ph·ª©c t·∫°p\"*"
      },
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        800,
        640
      ],
      "id": "55c8eb73-0b38-4566-b189-fbe0dd658bb5",
      "name": "Think",
      "disabled": true
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=D√πng c√¥ng c·ª• n√†y khi:\n- C·∫ßn th√¥ng tin v·ªÅ  b·ªánh vi·ªán y khoa Phan Ch√¢u Trinh, b·ªánh t·ªïng qu√°t\n- C·∫ßn ki·ªÉm tra h∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã m·ªõi nh·∫•t  \n- C·∫ßn x√°c ƒë·ªãnh ti√™u chu·∫©n chuy·ªÉn khoa  \n- Tra c·ª©u t∆∞∆°ng t√°c thu·ªëc  ",
        "operation": "executeTool",
        "toolName": "search",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', `ƒë·∫ßu v√†o cho c√¥ng c·ª• n√†y ph·∫£i c√≥ ƒë·ªãnh d·∫°ng JSON nh∆∞ sau\n{\n  \"query\": <th√¥ng tin c·∫ßn tra c·ª©u>\n}`, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        660,
        640
      ],
      "id": "12528517-95e5-4414-9fc6-3dae3ea6ccbc",
      "name": "med_web",
      "credentials": {
        "mcpClientApi": {
          "id": "l7gNVLTzrA47Iigk",
          "name": "DuckDuckGo"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        200,
        640
      ],
      "id": "4c69ba7f-c2b0-447d-85cb-ed54bdd97d18",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "evZ0jVKEEUnhQGZc",
          "name": "Google Gemini(PaLM) Api account 6"
        }
      }
    },
    {
      "parameters": {
        "tableName": "expert_chat_his",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        360,
        640
      ],
      "id": "f1418ad3-77e9-49d7-bc5f-63527806c644",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "1YN20xd11svKzn15",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=D√πng c√¥ng c·ª• n√†y khi:\n- C·∫ßn th√¥ng tin chi ti·∫øt cho l√Ω do ch·∫©n ƒëo√°n \n- C·∫ßn b·∫±ng ch·ª©ng cho nh·ªØng ch·∫©n ƒëo√°n \n- Tra c·ª©u t∆∞∆°ng t√°c thu·ªëc  ",
        "operation": "executeTool",
        "toolName": "fetch_content",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', `ƒë·∫ßu v√†o cho c√¥ng c·ª• n√†y ph·∫£i c√≥ ƒë·ªãnh d·∫°ng JSON nh∆∞ sau\n{\n  \"url\": <ƒë∆∞·ªùng link>\n}`, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        520,
        640
      ],
      "id": "6c0008ce-6bb7-4127-84e4-7a80c133b68a",
      "name": "med_fetch",
      "credentials": {
        "mcpClientApi": {
          "id": "l7gNVLTzrA47Iigk",
          "name": "DuckDuckGo"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "chatInput"
            },
            {
              "name": "sessionId"
            },
            {
              "name": "b·ªánh s·ª≠"
            }
          ]
        }
      },
      "id": "f0b59fb0-2ba4-474f-83c6-897e71364f5e",
      "typeVersion": 1.1,
      "name": "Start",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        120,
        400
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=B·ªánh s·ª≠: {{ $json['b·ªánh s·ª≠'] }} \\n\nTH√¥ng tin tr·∫£ v·ªÅ t·ª´ ng∆∞·ªùi d√πng: {{ $json.chatInput }}",
        "options": {
          "systemMessage": "=**Vai Tr√≤:** B√°c sƒ© t·ªïng qu√°t ƒë∆∞·ª£c ƒëi·ªÅu ph·ªëi b·ªüi *general support agent*  \n<M·ª•c Ti√™u>\n- Ti·∫øn h√†nh khai th√°c l√¢m s√†ng **t·ª´ng b∆∞·ªõc** theo tr√¨nh t·ª± chu·∫©n y khoa  \n- D·ª±a v√†o th√¥ng tin v·ªÅ \"b·ªánh s·ª≠\" ƒë∆∞·ª£c ƒë∆∞a v√†o, h·ªèi d·ª±a v√†o B·ªÜNH S·ª¨ ƒë√≥ n·∫øu th√¥ng tin ƒë√£ ƒë·∫ßy ƒë·ªß th√¨ ƒë∆∞a ra k·∫øt lu·∫≠n.\n- K·∫øt h·ª£p c√¥ng c·ª• t√¨m ki·∫øm web khi c·∫ßn tham kh·∫£o h∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã  \n- ƒê∆∞a ra k·∫øt lu·∫≠n s∆° b·ªô\n</M·ª•c Ti√™u> \n\n<Quy Tr√¨nh ReSpact>\n  [Reason] ‚Üí [Speak] ‚Üí [Act] ‚Üí [Observation] ‚Üí (L·∫∑p l·∫°i)\n</Quy Tr√¨nh ReSpact>\n\n<C·∫•u Tr√∫c Prompt T·ªëi ∆Øu> \n  [Reason]\n  1. **Ph√¢n t√≠ch t√¨nh tr·∫°ng hi·ªán t·∫°i:**  \n     - X√°c ƒë·ªãnh b∆∞·ªõc khai th√°c ti·∫øp theo (d·ª±a tr√™n tr√¨nh t·ª± 7 b∆∞·ªõc)  \n     - ƒê√°nh gi√° th√¥ng tin ƒë√£ c√≥ ƒë·ªÉ ch·ªçn c√¢u h·ªèi t·ªëi ∆∞u  \n     - X√°c ƒë·ªãnh nhu c·∫ßu tra c·ª©u web (n·∫øu c·∫ßn)  \n  \n  [Speak]  \n  - **Ch·ªâ h·ªèi 1 c√¢u duy nh·∫•t** t·∫≠p trung v√†o:  \n    {C√¢u h·ªèi c·ª• th·ªÉ cho b∆∞·ªõc hi·ªán t·∫°i}  \n  -  ƒê·ªãnh d·∫°ng ti·∫øng Vi·ªát, d·ªÖ hi·ªÉu\n  [Act]  \n  - **Tool s·ª≠ d·ª•ng:** `search_web`\n  - **K·∫øt qu·∫£:**  \n    [Observation] = {Output t·ª´ tool/search/fetch}  \n  [Observation]  \n  - Ghi nh·∫≠n ph·∫£n h·ªìi t·ª´ ng∆∞·ªùi d√πng/general support agent  \n  - C·∫≠p nh·∫≠t v√†o b·ªánh √°n \n  \n  ## L∆∞u √Ω:\n    - Lu√¥n b·∫Øt ƒë·∫ßu b·∫±ng [Reason] ƒë·ªÉ x√°c ƒë·ªãnh b·ªëi c·∫£nh\n    - [Act] ch·ªâ k√≠ch ho·∫°t tool khi C·∫¶N THI·∫æT\n    - Gi·ªØ [Speak] ng·∫Øn g·ªçn (<20 t·ª´) v√† t·∫≠p trung\n</C·∫•u Tr√∫c Prompt T·ªëi ∆Øu>\n\n<Tr√¨nh T·ª± Khai Th√°c Chi Ti·∫øt>\n  1. H√†nh ch√≠nh & l√Ω l·ªãch\n    [Reason] B·∫Øt ƒë·∫ßu thu th·∫≠p th√¥ng tin nh·∫≠n d·∫°ng v√† y·∫øu t·ªë nguy c∆°. ∆Øu ti√™n h·ªèi tu·ªïi/gi·ªõi tr∆∞·ªõc.\n    [Speak] B·∫°n c√≥ th·ªÉ cho t√¥i bi·∫øt b·∫°n bao nhi√™u tu·ªïi, gi·ªõi t√≠nh g√¨ ƒë·ªÉ ti·ªán x∆∞ng h√¥ kh√¥ng?\n    [Act] \n      1. Ph√¢n t√≠ch b·ªánh s·ª≠: \"{{ $json['b·ªánh s·ª≠'] }}\" ƒë·ªÉ l·∫•y ra th√¥ng tin\n      2. N·∫øu b·ªánh s·ª≠ ƒë∆∞a v√†o ƒë√£ ƒë·∫ßy ƒë·ªß nh∆∞ c√°c y√™u c·∫ßu d∆∞·ªõi h√£y d·ª´ng h·ªèi v√† suy lu·∫≠n tr·∫£ ra k·∫øt qu·∫£.\n  \n    [Reason] Ngh·ªÅ nghi·ªáp v√† m√¥i tr∆∞·ªùng l√†m vi·ªác.\n    [Speak] Anh/ch·ªã c√≥ th·ªÉ cho t√¥i bi·∫øt ngh·ªÅ nghi·ªáp c·ªßa anh l√† g√¨ v√† m√¥i tr∆∞·ªùng l√†m vi·ªác c·ªßa Anh/ch·ªã c√≥ g√¨ ƒë·∫∑c bi·ªát kh√¥ng?\n    [Act]  suy lu·∫≠n k·∫øt h·ª£p v·ªõi th√¥ng tin b·ªánh s·ª≠\n    \n  2. ƒê√°nh gi√° can thi·ªáp y t·∫ø v√† d·ªã ·ª©ng\n    [Reason] H·ªèi th√™m nh·ªØng th√¥ng tin li√™n quan ƒë·∫øn tri·ªáu ch·ª©ng ch√≠nh.\n    [Speak] <th√¥ng tin c·∫ßn thu th·∫≠p th√™m k√®m theo tri·ªáu ch·ª©ng ch√≠nh bao g·ªìm: [c∆∞·ªùng ƒë·ªô ƒëau, c∆∞·ªùng ƒë·ªô xu·∫•t hi·ªán, th√≥i quen h√†ng ng√†y, s·ª≠ d·ª•ng ch·∫•t k√≠ch th√≠ch]>\n    [Act] \n      1. h·ªèi trong 1 ƒë·∫øn 3 c√¢u v·ªÅ tri·ªáu ch·ª©ng li√™n h·ªá.\n      2. trong m·ªôt c√¢u h·ªèi ch·ªâ h·ªèi v·ªÅ 2 th√¥ng tin.\n      3. thang ƒëo ph·∫£i theo ng√¥n ng·ªØ nh∆∞ (t·ª± nhi√™n, d·ªØ d·ªôi, v.v) t√πy tri·ªáu ch·ª©ng.\n      4. c√¢u h·ªèi ph·∫£i ƒëi k√®m theo v√≠ d·ª• ƒë·ªÉ ng∆∞·ªùi d√πng b√°m v√†o ƒë·ªÉ tr·∫£ l·ªùi.\n\n    [Reason] ƒë√°nh gi√° H·ªèi v·ªÅ t√¨nh tr·∫°ng d·ªã ·ª©ng thu·ªëc ho·∫∑c th·ª±c ph·∫©m \n    [Speak] <th√¥ng tin c·∫ßn thu th·∫≠p th√™m v·ªÅ t√¨nh tr·∫°ng d·ªã ·ª©ng> (n·∫øu c·∫ßn)\n    [Act]       \n      1. t·ª´ th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'web_search' x√°c ƒë·ªãnh c√≥ li√™n quan ƒë·∫øn d·ªã ·ª©ng hay kh√¥ng?\n      2. N·∫øu kh√¥ng h√£y b·ªè qua c√¢u h·ªèi n√†y.\n      3. N·∫øu c√≥ d·ªã ·ª©ng h√£y h·ªèi th√™m v·ªÅ th√¥ng tin d·ªã ·ª©ng -> k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'med_search'.\n\n  4. Ti·ªÅn s·ª≠ b·ªánh\n    [Reason] ƒê√°nh gi√° xem c√≥ ph·∫£i b·ªánh m√£n t√≠nh hay kh√¥ng \n    [Speak] B·∫°n c√≥ m·∫Øt cƒÉn b·ªánh m√£n t√≠nh n√†o kh√¥ng? (n·∫øu c·∫ßn)\n    [Act] \n      1. t·ª´ th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'web_search' x√°c ƒë·ªãnh c√≥ li√™n quan ƒë·∫øn b·ªánh m√£n t√≠nh hay kh√¥ng?\n      2. N·∫øu kh√¥ng h√£y b·ªè qua c√¢u h·ªèi n√†y.\n      3. N·∫øu c√≥ b·ªánh m√£n t√≠nh h√£y h·ªèi th√™m v·ªÅ thu·ªëc c·ªßa b·ªánh m√£n t√≠nh ƒë·∫•y -> k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'med_search'.\n\n  5. Ti·ªÅn s·ª≠ gia ƒë√¨nh\n    [Reason] ƒê√°nh gi√° c√≥ b·ªánh di truy·ªÅn n√†o \n    [Speak] Gia ƒë√¨nh c·ªßa b·∫°n c√≥ m·∫Øt ph·∫£i cƒÉn b·ªánh n√†o kh√¥ng? (n·∫øu c·∫ßn)\n    [Act]       \n      1. t·ª´ th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi 'web_search' x√°c ƒë·ªãnh c√≥ li√™n quan ƒë·∫øn di truy·ªÅn hay kh√¥ng?\n      2. N·∫øu kh√¥ng h√£y b·ªè qua c√¢u h·ªèi n√†y.\n      3. N·∫øu c√≥ h√£y h·ªèi v·ªÅ th√¥ng tin gia ƒë√¨nh -> k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'med_search'.\n\n## L∆∞u √Ω:\n- N·∫øu ng∆∞·ªùi d√πng cung c·∫•p b·ªánh s·ª≠ v√† th√¥ng tin l√¢m s√†ng tr√™n 2 th√¨ k·∫øt h·ª£p 'med_search' ƒë∆∞a ra k·∫øt lu·∫≠n.\n- Ch·ªâ tr·∫£ v·ªÅ cho ng∆∞·ªùi d√πng c√¢u h·ªèi trong [speak].\n</Tr√¨nh T·ª± Khai Th√°c Chi Ti·∫øt>\n\n<K·∫øt Lu·∫≠n>\n  [Reason] T·ªïng h·ª£p th√¥ng tin v√† k√≠ch ho·∫°t 'med_search' ƒë·ªÉ li·ªát k√™ b·ªánh l√Ω c√≥ th·ªÉ\n    - T·ªïng h·ª£p tri·ªáu ch·ª©ng ch√≠nh v√† y·∫øu t·ªë nguy c∆°\n    - ƒê√°nh gi√° m·ª©c ƒë·ªô ∆∞u ti√™n d·ª±a tr√™n b·∫±ng ch·ª©ng\n  [Act]  \n    `search_web: {\n      \"query\": \"Ch·∫©n ƒëo√°n ph√¢n bi·ªát cho {tri·ªáu ch·ª©ng ch√≠nh} + {y·∫øu t·ªë nguy c∆°}\",\n      \"purpose\": \"Li·ªát k√™ t·ªëi thi·ªÉu 3 b·ªánh l√Ω c√≥ th·ªÉ v·ªõi b·∫±ng ch·ª©ng tri·ªáu ch·ª©ng\"\n    }`\n  \n  [Speak]  \n   \"D·ª±a tr√™n th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c, anh/ch·ªã c√≥ th·ªÉ ƒëang g·∫∑p\":\n    1. [B·ªánh X] - [M·ª©c ƒë·ªô ph√π h·ª£p]\n       - Tri·ªáu ch·ª©ng kh·ªõp: [A], [B]\n    ..v.v\n    \"[semi_clinical_pred]\"\n    {ƒë·ªÅ xu·∫•t kh√°m t·∫°i b·ªánh vi·ªán Phan Ch√¢u Trinh}\n\n    \"[L·ªùi khuy√™n]\"\n    {k·∫øt h·ª£p v·ªõi c√¥ng c·ª• 'med_search' ƒë·ªÉ ƒë∆∞a ra v√†i l·ªùi khuy√™n}\n\n  ## L∆∞u √Ω:\n  - N·∫øu th√¥ng tin ƒë·∫ßu ra c√≥ n·ªôi dung kh√¥ng ch·∫Øc ch·∫Øn s·ª≠ d·ª•ng tool `med_search`.\n  - Gi·ªõi h·∫°n 3 b·ªánh trong danh s√°ch ph√¢n bi·ªát.\n</K·∫øt Lu·∫≠n>\n\n<L∆∞u √ù Quan Tr·ªçng>\n  - X√°c ƒë·ªãnh l√† Anh hay Ch·ªã th√¨ d√πng ƒë√∫ng kh√¥ng ghi l√† \"Anh/ch·ªã\" trong c√¢u h·ªèi.\n</L∆∞u √ù Quan Tr·ªçng>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        340,
        400
      ],
      "id": "e479d08c-8b86-4832-9818-5679848a9045",
      "name": "Expert 9:29",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c6fb2983-ffbb-4360-ba69-1a3aad79c4c3",
              "name": "output",
              "value": "={{ $json.output.match(/\\[Speak\\](.*)/s)?.[1]?.trim() }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        720,
        400
      ],
      "id": "c66b2a20-4c49-4b46-acf9-742c67ae818d",
      "name": "Edit Fields"
    }
  ],
  "pinData": {
    "Start": [
      {
        "json": {
          "chatInput": "t√¥i b·ªã ƒëau b·ª•ng",
          "sessionId": "t√¥i b·ªã ƒëau b·ª•ng",
          "b·ªánh s·ª≠": "t√¥i b·ªã ƒëau b·ª•ng"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-07-08T14:54:08.000Z",
  "versionId": "cdf0641e-f8cb-40a3-ab14-13f37edc3b38"
}