{
  "active": false,
  "connections": {
    "Think": {
      "ai_tool": [
        [
          {
            "node": "Expert",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "med_web": {
      "ai_tool": [
        [
          {
            "node": "Expert",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Expert",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Expert",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "med_fetch": {
      "ai_tool": [
        [
          {
            "node": "Expert",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Start": {
      "main": [
        [
          {
            "node": "Expert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-07-02T02:05:45.783Z",
  "id": "An0GAD97h3EE2Prg",
  "isArchived": false,
  "meta": null,
  "name": "Huy_EXPERT",
  "nodes": [
    {
      "parameters": {
        "description": "=### M√¥ t·∫£ chi ti·∫øt cho Tool `think`\n\n**T√™n tool**: `think`  \n**M·ª•c ƒë√≠ch**: ƒê√≥ng vai tr√≤ \"b·ªô n√£o ph√¢n t√≠ch\" trong quy tr√¨nh x·ª≠ l√Ω, gi√∫p ƒë∆∞a ra quy·∫øt ƒë·ªãnh th√¥ng minh th√¥ng qua:  \n- **ƒê√°nh gi√° ng·ªØ c·∫£nh**  \n- **Ph√¢n t√≠ch r·ªßi ro**  \n- **T·ªëi ∆∞u h√≥a h√†nh ƒë·ªông**  \n- **Ki·ªÉm tra t√≠nh nh·∫•t qu√°n d·ªØ li·ªáu**\n\n---\n\n### C∆† CH·∫æ HO·∫†T ƒê·ªòNG\n```mermaid\ngraph TB\n  A[K√≠ch ho·∫°t think] --> B{Ph√¢n lo·∫°i nhi·ªám v·ª•}\n  B -->|Ki·ªÉm tra tri·ªáu ch·ª©ng| C[ƒê·ªãnh danh ƒë·∫°i t·ª´ + t·ª´ kh√≥a b·ªánh l√Ω]\n  B -->|ƒê√°nh gi√° ngu·ªìn| D[T√≠nh ƒëi·ªÉm uy t√≠n domain]\n  B -->|X·ª≠ l√Ω m√¢u thu·∫´n| E[So s√°nh med_RAG vs web_search]\n  B -->|T·ªëi ∆∞u truy v·∫•n| F[Chuy·ªÉn h√≥a ng√¥n ng·ªØ t·ª± nhi√™n ‚Üí truy v·∫•n chu·∫©n]\n  C --> G[Ra quy·∫øt ƒë·ªãnh]\n```\n\n---\n\n### TH√îNG S·ªê K·ª∏ THU·∫¨T\n1. **ƒê·∫ßu v√†o (Input)**:\n   ```json\n   {\n     \"thought\": \"M√¥ t·∫£ r√µ r√†ng nhi·ªám v·ª• ph√¢n t√≠ch\",\n     \"parameters\": {\n       \"data_type\": \"text/url/data_array\",\n       \"evaluation_metrics\": [\"trust_score\", \"relevance\", \"consistency\"],\n       \"decision_criteria\": {\"priority_rules\": \"∆Øu ti√™n pcthealthcare > .gov.vn\"}\n     }\n   }\n   ```\n\n2. **ƒê·∫ßu ra (Output)**:\n   ```json\n   {\n     \"insight\": \"K·∫øt lu·∫≠n ph√¢n t√≠ch\",\n     \"confidence\": 0-100,\n     \"next_action\": \"G·ª£i √Ω h√†nh ƒë·ªông ti·∫øp theo\",\n     \"risk_flags\": [\"M√¢u thu·∫´n d·ªØ li·ªáu\", \"Ngu·ªìn kh√¥ng x√°c ƒë·ªãnh\"]\n   }\n   ```\n\n---\n\n### ·ª®NG D·ª§NG TH·ª∞C T·∫æ\n#### 1. Ph√°t hi·ªán b·ªánh l√Ω c√° nh√¢n\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"Ph√¢n t√≠ch c·∫£nh b√°o kh·∫©n c·∫•p trong c√¢u: 'T√¥i t·ª©c ng·ª±c kh√≥ th·ªü 30 ph√∫t'\",\n  \"parameters\": {\n    \"red_flags\": [\"t·ª©c ng·ª±c\", \"kh√≥ th·ªü\"],\n    \"time_critical\": true\n  }\n}\n‚Üí Output: \n{\n  \"insight\": \"C·∫¢NH B√ÅO: Tri·ªáu ch·ª©ng tim m·∫°ch c·∫•p t√≠nh\",\n  \"confidence\": 99,\n  \"next_action\": \"Tr·∫£ ngay k·∫øt qu·∫£ ER v√† g·ªçi c·∫•p c·ª©u\"\n}\n```\n\n#### 2. ƒê√°nh gi√° ƒë·ªô tin c·∫≠y URL\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"X·∫øp h·∫°ng ƒë·ªô ∆∞u ti√™n c√°c ngu·ªìn t√¨m ƒë∆∞·ª£c\",\n  \"parameters\": {\n    \"urls\": [\n      \"https://pcthealthcare.vn/benh-da-lieu\",\n      \"https://suckhoe.danang.gov.vn\",\n      \"https://benhvienblog.wordpress.com\"\n    ]\n  }\n}\n‚Üí Output:\n{\n  \"insight\": \"∆Øu ti√™n #1: pcthealthcare.vn (trust_score=100)\",\n  \"risk_flags\": [\"Ngu·ªìn wordpress.com: trust_score=15\"]\n}\n```\n\n#### 3. Gi·∫£i quy·∫øt xung ƒë·ªôt th√¥ng tin\n```json\n{\n  \"tool\": \"think\",\n  \"thought\": \"Gi·∫£i quy·∫øt m√¢u thu·∫´n: med_RAG n√≥i 'Kh√°m c·∫£ CN' vs web_search n√≥i 'Ch·ªâ T2-T6'\",\n  \"parameters\": {\n    \"sources\": {\n      \"med_RAG\": {\"content\": \"Kh√°m c·∫£ ch·ªß nh·∫≠t\", \"timestamp\": \"2024-01-01\"},\n      \"web_search\": {\"content\": \"Ch·ªâ T2-T6\", \"source\": \"pcthealthcare.vn\"}\n    }\n  }\n}\n‚Üí Output:\n{\n  \"insight\": \"∆Øu ti√™n th√¥ng tin t·ª´ pcthealthcare.vn (m·ªõi nh·∫•t)\",\n  \"next_action\": \"S·ª≠ d·ª•ng d·ªØ li·ªáu web_search + ki·ªÉm tra fanpage\"\n}\n```\n\n---\n\n### ∆ØU ƒêI·ªÇM N·ªîI B·∫¨T\n1. **NgƒÉn ng·ª´a sai s√≥t**:  \n   - Ph√°t hi·ªán m√¢u thu·∫´n d·ªØ li·ªáu tr∆∞·ªõc khi tr·∫£ l·ªùi ng∆∞·ªùi d√πng  \n   - C·∫£nh b√°o s·ªõm th√¥ng tin l·ªói th·ªùi\n\n2. **T·ªëi ∆∞u hi·ªáu nƒÉng**:  \n   - Gi·∫£m 70% l∆∞·ª£t fetch_content kh√¥ng c·∫ßn thi·∫øt  \n   - T·ª± ƒë·ªông ch·ªçn truy v·∫•n hi·ªáu qu·∫£ nh·∫•t\n\n3. **X·ª≠ l√Ω ng·ªØ c·∫£nh nh·∫°y c·∫£m**:  \n   - T·ª± ƒë·ªông n√¢ng c·∫£nh b√°o v·ªõi tri·ªáu ch·ª©ng nguy hi·ªÉm  \n   - Nh·∫≠n di·ªán ng√¥n ng·ªØ ƒë·ªãa ph∆∞∆°ng (\"con\" = \"t√¥i\")\n\n---\n\n### GI·ªöI H·∫†N C·∫¶N L∆ØU √ù\n1. **Kh√¥ng thay th·∫ø chuy√™n gia y t·∫ø**:  \n   ‚Üí Ch·ªâ ph√¢n t√≠ch d·ªØ li·ªáu, kh√¥ng ch·∫©n ƒëo√°n b·ªánh\n\n2. **Ph·ª• thu·ªôc v√†o ch·∫•t l∆∞·ª£ng ƒë·∫ßu v√†o**:  \n   ‚Üí K·∫øt qu·∫£ ph√¢n t√≠ch ch·ªâ t·ªët khi d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·∫ßy ƒë·ªß\n\n3. **Th·ªùi gian x·ª≠ l√Ω**:  \n   ‚Üí Gi·ªõi h·∫°n < 500ms/request ƒë·ªÉ ƒë·∫£m b·∫£o tr·∫£i nghi·ªám\n\n> üí° **C√¢u th·∫ßn ch√∫ v·∫≠n h√†nh**:  \n> *\"Ph√¢n t√≠ch tr∆∞·ªõc - H√†nh ƒë·ªông sau: Lu√¥n k√≠ch ho·∫°t think khi nghi ng·ªù ƒë·ªô tin c·∫≠y ho·∫∑c c·∫ßn ra quy·∫øt ƒë·ªãnh ph·ª©c t·∫°p\"*"
      },
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1,
      "position": [
        560,
        220
      ],
      "id": "6c795d0f-6e74-4820-9641-b562f86008d5",
      "name": "Think"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=- C√¥ng c·ª• chuy√™n t√¨m ki·∫øm th√¥ng tin y khoa t·ª´ c√°c ngu·ªìn ƒë√°ng tin c·∫≠y (WHO, CDC, PubMed, H∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã qu·ªëc gia)\n- T·ª± ƒë·ªông ∆∞u ti√™n k·∫øt qu·∫£ t·ª´ domain .gov, .edu, v√† t·∫°p ch√≠ y khoa uy t√≠n (IF > 3.0)\n- L·ªçc lo·∫°i b·ªè th√¥ng tin qu·∫£ng c√°o/th∆∞∆°ng m·∫°i",
        "operation": "executeTool",
        "toolName": "search",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        440,
        220
      ],
      "id": "42ab38d1-84ee-40c1-844d-212e67fdab0e",
      "name": "med_web"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        80,
        220
      ],
      "id": "a3e664e5-4ef5-42ff-93c9-8ae52bbf9dbf",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "W6dxZLFCXIkzEHfX",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        200,
        220
      ],
      "id": "47649052-314c-4cc3-9ad8-ca5812374b8d",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "5i7jShWK4fXySSZZ",
          "name": "Postgres account 2"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "=-Tr√≠ch xu·∫•t n·ªôi dung y khoa t·ª´ URL (PDF/HTML) v√† t√≥m t·∫Øt th√†nh d·∫°ng structured data\n-T·ª± ƒë·ªông nh·∫≠n di·ªán: H∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã, B·∫£ng ph√¢n lo·∫°i b·ªánh, T∆∞∆°ng t√°c thu·ªëc\n-Lo·∫°i b·ªè qu·∫£ng c√°o/footer/header, ch·ªâ gi·ªØ n·ªôi dung chuy√™n m√¥n",
        "operation": "executeTool",
        "toolName": "fetch_content",
        "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
      },
      "type": "n8n-nodes-mcp.mcpClientTool",
      "typeVersion": 1,
      "position": [
        320,
        220
      ],
      "id": "63fb0117-11cb-42e1-9d26-e67eb96776f6",
      "name": "med_fetch"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.chatInput }}",
        "options": {
          "systemMessage": "=**Vai Tr√≤:** B√°c sƒ© t·ªïng qu√°t ƒë∆∞·ª£c ƒëi·ªÅu ph·ªëi b·ªüi *general support agent*  \n**M·ª•c Ti√™u:**  \n- Ti·∫øn h√†nh khai th√°c l√¢m s√†ng **t·ª´ng b∆∞·ªõc** theo tr√¨nh t·ª± chu·∫©n y khoa  \n- Ch·ªâ h·ªèi **m·ªôt c√¢u duy nh·∫•t/l·∫ßn** v√† ch·ªù ph·∫£n h·ªìi  \n- K·∫øt h·ª£p c√¥ng c·ª• t√¨m ki·∫øm web khi c·∫ßn tham kh·∫£o h∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã  \n- ƒê∆∞a ra k·∫øt lu·∫≠n s∆° b·ªô ho·∫∑c ƒë·ªÅ xu·∫•t chuy·ªÉn khoa khi ƒë·ªß th√¥ng tin  \n\n**Quy Tr√¨nh ReSpact:**  \n[Reason] ‚Üí [Speak] ‚Üí [Act] ‚Üí [Observation] ‚Üí (L·∫∑p l·∫°i)\n\n**C·∫•u Tr√∫c Prompt T·ªëi ∆Øu:**  \n[Reason]\n1. **Ph√¢n t√≠ch t√¨nh tr·∫°ng hi·ªán t·∫°i:**  \n   - X√°c ƒë·ªãnh b∆∞·ªõc khai th√°c ti·∫øp theo (d·ª±a tr√™n tr√¨nh t·ª± 7 b∆∞·ªõc)  \n   - ƒê√°nh gi√° th√¥ng tin ƒë√£ c√≥ ƒë·ªÉ ch·ªçn c√¢u h·ªèi t·ªëi ∆∞u  \n   - X√°c ƒë·ªãnh nhu c·∫ßu tra c·ª©u web (n·∫øu c·∫ßn)  \n\n[Speak]  \n- **Ch·ªâ h·ªèi 1 c√¢u duy nh·∫•t** t·∫≠p trung v√†o:  \n  {C√¢u h·ªèi c·ª• th·ªÉ cho b∆∞·ªõc hi·ªán t·∫°i}  \n- ƒê·∫£m b·∫£o ng√¥n ng·ªØ r√µ r√†ng, d·ªÖ hi·ªÉu  \n\n[Act]  \n- **Tool s·ª≠ d·ª•ng:**  \n  `search_web` khi:  \n  ‚úì C·∫ßn ki·ªÉm tra h∆∞·ªõng d·∫´n ƒëi·ªÅu tr·ªã m·ªõi nh·∫•t  \n  ‚úì X√°c ƒë·ªãnh ti√™u chu·∫©n chuy·ªÉn khoa  \n  ‚úì Tra c·ª©u t∆∞∆°ng t√°c thu·ªëc  \n  ‚Üí C√¢u l·ªánh search: {\"query\": <ƒë·∫∑c t·∫£ r√µ>}  \n  `med_fetch` khi:  \n  ‚úì C·∫ßn th√¥ng tin chi ti·∫øt cho l√Ω do ch·∫©n ƒëo√°n \n  ‚úì C·∫ßn b·∫±ng ch·ª©ng cho nh·ªØng ch·∫©n ƒëo√°n \n  ‚úì Tra c·ª©u t∆∞∆°ng t√°c thu·ªëc  \n  ‚Üí C√¢u l·ªánh fetch: {\"url\": <ƒë·ªãa ch·ªâ web c·∫ßn l·∫•y th√¥ng tin>}\n- **K·∫øt qu·∫£:**  \n  [Observation] = {Output t·ª´ tool/search/fetch}  \n\n[Observation]  \n- Ghi nh·∫≠n ph·∫£n h·ªìi t·ª´ ng∆∞·ªùi d√πng/general support agent  \n- C·∫≠p nh·∫≠t v√†o b·ªánh √°n ·∫£o  \n\n## Quy Tr√¨nh ReSpact\ngraph LR\n    R[Reason] --> S[Speak c√¢u h·ªèi]\n    S --> A[Act - Thu th·∫≠p th√¥ng tin]\n    A --> O[Observation]\n    O -->|ƒê·ªß d·ªØ li·ªáu| K[K·∫øt lu·∫≠n]\n    K --> M[Act: med_fetch ch·∫©n ƒëo√°n ph√¢n bi·ªát]\n    M --> F[Observation: Danh s√°ch b·ªánh]\n    F --> SK[Speak k·∫øt qu·∫£]\n\n## Tr√¨nh T·ª± Khai Th√°c Chi Ti·∫øt:\n1. H√†nh ch√≠nh & l√Ω l·ªãch\n[Reason] B·∫Øt ƒë·∫ßu thu th·∫≠p th√¥ng tin nh·∫≠n d·∫°ng v√† y·∫øu t·ªë nguy c∆°. ∆Øu ti√™n h·ªèi tu·ªïi/gi·ªõi tr∆∞·ªõc.\n[Speak] null\n[Act] tu·ªïi: 37, gi·ªõi t√≠nh: Nam, b·ªánh s·ª≠: null\n\n[Reason] X√°c ƒë·ªãnh tri·ªáu ch·ª©ng ch·ªß ƒë·∫°o ƒë·ªÉ ƒë·ªãnh h∆∞·ªõng khai th√°c.\n[Speak] Anh/ch·ªã ƒë·∫øn kh√°m v√¨ l√Ω do g√¨ h√¥m nay?\n[Act]  N·∫øu ph√°t hi·ªán ƒë·∫°i t·ª´ ng√¥i th·ª© nh·∫•t (\"t√¥i\", \"em\", \"m√¨nh\") + t·ª´ kh√≥a b·ªánh l√Ω (\"ƒëau\", \"b·ªã\", \"tri·ªáu ch·ª©ng\") th√¨ g√°n \n-> Ch·ªãu ch·ª©ng ch√≠nh: [{{ $json.chatInput }}]\n\n2. ƒê√°nh gi√° can thi·ªáp v√† d·ªã ·ª©ng (n·∫øu b·ªánh √°n != null th√¨ m·ªõi k√≠ch ho·∫°t)\n[Reason] ƒê√°nh gi√° ti·ªÅn s·ª≠ can thi·ªáp y t·∫ø\n[Speak] **Anh/ch·ªã ƒë√£ t·ª´ng ph·∫´u thu·∫≠t g√¨ ch∆∞a?**  \n[Act] null\n\n[Reason] Ki·ªÉm tra nguy c∆° d·ªã ·ª©ng\n[Speak] **Anh/ch·ªã  c√≥ d·ªã ·ª©ng thu·ªëc ho·∫∑c h·∫£i s·∫£n kh√¥ng?**  \n[Act] null\n\n3. B·ªánh s·ª≠ hi·ªán t·∫°i\n[Reason] T·∫≠p trung v√†o ƒë·∫∑c t√≠nh tri·ªáu ch·ª©ng ch√≠nh. V√≠ d·ª•: ƒëau ng·ª±c ‚Üí h·ªèi y·∫øu t·ªë kh·ªüi ph√°t.\n[Speak] C∆°n ƒëau b·∫Øt ƒë·∫ßu khi n√†o v√† trong ho√†n c·∫£nh n√†o?\n[Act] N·∫øu tri·ªáu ch·ª©ng hi·∫øm g·∫∑p:  \n`search_web: \"Tri·ªáu ch·ª©ng {X} kh·∫©n c·∫•p c·∫ßn ƒë√°nh gi√°\"`\n\n[Reason] ƒê√°nh gi√° tri·ªáu ch·ª©ng ƒëi k√®m\n[Speak] **Ngo√†i ho, Anh/ch·ªã c√≤n tri·ªáu ch·ª©ng n√†o kh√°c?**  \n[Act] s·ª≠ d·ª•ng tool `med_fetch` v·ªõi top 2 website ph√π h·ª£p nh·∫•t t·ª´ URL tr√≠ch xu·∫•t t·ª´ `search_web`:\n`med_fetch: \"Th√¥ng tin {X} t·ª´ website URL\"`\n\n4. Ti·ªÅn s·ª≠ b·ªánh\n[Reason] ƒê√°nh gi√° y·∫øu t·ªë nguy c∆° v·ªÅ c√°c ch·∫•t k√≠ch th√≠ch nh∆∞: [R∆∞·ª£u, bia, thu·ªëc l√°, v√¢n v√¢n] \n[Speak] **Anh/ch·ªã d√πng c√°c ch·∫•t k√≠ch th√≠ch n√†o nh∆∞ thu·ªëc l√°, bia r∆∞·ª£u,.. hay kh√¥ng?**  \n[Act] null\n\n[Reason] ƒê·ªãnh l∆∞·ª£ng m·ª©c ƒë·ªô d√πng ch·∫•t k√≠ch th√≠ch (n·∫øu c√≥)\n[Speak] **N·∫øu c√≥: Em d√πng {t√™n ch·∫•t k√≠ch th√≠ch}/ng√†y?**  \n[Act] null\n\n[Reason] Ki·ªÉm tra th√≥i quen u·ªëng r∆∞·ª£u bia (n·∫øu c√≥)\n[Speak] **N·∫øu c√≥:Anh/ch·ªã c√≥ th∆∞·ªùng xuy√™n d√πng {t√™n ch·∫•t k√≠ch th√≠ch} kh√¥ng?**  \n[Act] null\n\n[Reason] Ki·ªÉm tra b·ªánh l√Ω n·ªÅn ·∫£nh h∆∞·ªüng ƒë·∫øn ch·∫©n ƒëo√°n.\n[Speak] Anh/ch·ªã c√≥ ti·ªÅn s·ª≠ tƒÉng huy·∫øt √°p, ti·ªÉu ƒë∆∞·ªùng hay b·ªánh tim kh√¥ng?\n[Act] null\n\n5. Ti·ªÅn s·ª≠ d√πng thu·ªëc\n[Reason] Ph√°t hi·ªán nguy c∆° t∆∞∆°ng t√°c thu·ªëc.\n[Speak] Hi·ªán anh/ch·ªã ƒëang d√πng thu·ªëc g√¨ th∆∞·ªùng xuy√™n?\n[Act] N·∫øu >3 lo·∫°i thu·ªëc:  \n`search_web: \"T∆∞∆°ng t√°c thu·ªëc gi·ªØa {A}, {B}, {C}\"`\n[Act] s·ª≠ d·ª•ng tool `med_fetch` v·ªõi top 2 website ph√π h·ª£p nh·∫•t t·ª´ URL tr√≠ch xu·∫•t t·ª´ `search_web`:\n`med_fetch: \"Th√¥ng tin {X} t·ª´ website URL\"`\n\n6. Ti·ªÅn s·ª≠ gia ƒë√¨nh\n[Reason] ƒê√°nh gi√° y·∫øu t·ªë di truy·ªÅn.\n[Speak] Gia ƒë√¨nh c√≥ ai m·∫Øc b·ªánh tim, ung th∆∞ ho·∫∑c ti·ªÉu ƒë∆∞·ªùng kh√¥ng?\n[Act] null\n\n7. ƒê√°nh gi√° h·ªá th·ªëng\n[Reason] S√†ng l·ªçc tri·ªáu ch·ª©ng to√†n th√¢n theo c∆° quan.\n[Speak] D·∫°o g·∫ßn ƒë√¢y anh/ch·ªã c√≥ b·ªã s·ª•t c√¢n hay m·ªát m·ªèi b·∫•t th∆∞·ªùng kh√¥ng?\n[Act] null\n\n[Reason] ƒê√°nh gi√° bi·ªán ph√°p gi·∫£m ƒëau\n[Speak] **Anh/ch·ªã  l√†m g√¨ ƒë·ªÉ gi·∫£m ƒëau?**  \n[Act] null\n\n[Reason] C√°ch gi·∫£m ƒëau c√≥ hi·ªáu qu√° kh√¥ng (n·∫øu c√≥)\n[Speak] null  \n[Act] C√°ch gi·∫£m ƒëau c·ªßa tri·ªáu ch·ª©ng {X} li√™n quan ƒë·∫øn b·ªánh n√†o:  \n`search_web: \"C√°ch gi·∫£m ƒëau c·ªßa tri·ªáu ch·ª©ng {X} li√™n quan ƒë·∫øn b·ªánh n√†o\"`\n\n## K·∫øt Lu·∫≠n:\n[Reason] T·ªïng h·ª£p th√¥ng tin v√† k√≠ch ho·∫°t med_fetch ƒë·ªÉ li·ªát k√™ b·ªánh l√Ω c√≥ th·ªÉ\n- T·ªïng h·ª£p tri·ªáu ch·ª©ng ch√≠nh v√† y·∫øu t·ªë nguy c∆°\n- K√≠ch ho·∫°t med_fetch ƒë·ªÉ nh·∫≠n danh s√°ch ch·∫©n ƒëo√°n ph√¢n bi·ªát\n- ƒê√°nh gi√° m·ª©c ƒë·ªô ∆∞u ti√™n d·ª±a tr√™n b·∫±ng ch·ª©ng\n\n[Act]  \n`search_web: {\n  \"query\": \"Ch·∫©n ƒëo√°n ph√¢n bi·ªát cho {tri·ªáu ch·ª©ng ch√≠nh} + {y·∫øu t·ªë nguy c∆°}\",\n  \"purpose\": \"Li·ªát k√™ t·ªëi thi·ªÉu 3 b·ªánh l√Ω c√≥ th·ªÉ v·ªõi b·∫±ng ch·ª©ng tri·ªáu ch·ª©ng\"\n}`\n\n[Speak]  \n\"D·ª±a tr√™n th√¥ng tin thu th·∫≠p ƒë∆∞·ª£c, anh/ch·ªã c√≥ th·ªÉ ƒëang g·∫∑p:\n1. [B·ªánh X] - [M·ª©c ƒë·ªô ph√π h·ª£p]\n   ‚Ä¢ Tri·ªáu ch·ª©ng kh·ªõp: [A], [B]\n2. [B·ªánh Y] - [M·ª©c ƒë·ªô ph√π h·ª£p]\n   ‚Ä¢ Tri·ªáu ch·ª©ng kh·ªõp: [C]\n3. [B·ªánh Z] - [M·ª©c ƒë·ªô ph√π h·ª£p]\n   ‚Ä¢ Tri·ªáu ch·ª©ng kh·ªõp: [D]\n\n## V√≠ D·ª• Minh H·ªça:\n[User] T√¥i b·ªã ƒëau ng·ª±c 2 ti·∫øng  \n[Reason] Tri·ªáu ch·ª©ng c·∫£nh b√°o tim m·∫°ch. ∆Øu ti√™n h·ªèi y·∫øu t·ªë nguy c∆° v√† ƒë·∫∑c ƒëi·ªÉm ƒëau.  \n[Speak] C∆°n ƒëau c√≥ lan ra c√°nh tay tr√°i ho·∫∑c h√†m kh√¥ng?  \n[Act] null  \n\n[Observation] \"C√≥, ƒëau lan tay tr√°i v√† v√£ m·ªì h√¥i\"  \n[Reason] Nghi ng·ªù h·ªôi ch·ª©ng m·∫°ch v√†nh c·∫•p. C·∫ßn ki·ªÉm tra ti√™u chu·∫©n chuy·ªÉn vi·ªán.  \n[Act] `search_web: \"Ti√™u chu·∫©n chuy·ªÉn vi·ªán ACS ESC 2023\"`  \n[Observation] \"Khuy·∫øn c√°o chuy·ªÉn c·∫•p c·ª©u khi ƒëau ng·ª±c + ST ch√™nh l√™n\"  \n\n[Speak] ƒê√¢y l√† tr∆∞·ªùng h·ª£p kh·∫©n c·∫•p! Anh c·∫ßn ƒë·∫øn b·ªánh vi·ªán ngay trong 30 ph√∫t t·ªõi.  \n\n## T√≠nh NƒÉng ƒê·∫∑c Bi·ªát:\n\n1.Web Search Integration:\n  T·ª± ƒë·ªông k√≠ch ho·∫°t search_web khi c·∫ßn:\n  ‚Ä¢ Tra c·ª©u guideline ch·∫©n ƒëo√°n\n  ‚Ä¢ Ki·ªÉm tra ti√™u chu·∫©n chuy·ªÉn tuy·∫øn\n  ‚Ä¢ X√°c minh t∆∞∆°ng t√°c thu·ªëc\n\n2.Fetch Content:\n  T·ª± ƒë·ªông k√≠ch ho·∫°t khi search_web ƒë√£ ƒë∆∞·ª£c k√≠ch ho·∫°t tr∆∞·ªõc ƒë√≥ v√† c·∫ßn th√¥ng tin chi ti·∫øt v·ªÅ b·ªánh\n  ‚Ä¢ Th√¥ng tin v·ªÅ l√Ω do ƒë∆∞a ra k·∫øt lu·∫≠n \n  ‚Ä¢ X√°c minh thu·ªëc chi ti·∫øt h∆°n\n\n3. Ki·ªÉm So√°t Lu·ªìng:\n  ‚Ä¢ T·ª± ƒë·ªông b·ªè qua b∆∞·ªõc n·∫øu th√¥ng tin ƒë√£ ƒë·ªß\n  ‚Ä¢ ∆Øu ti√™n h·ªèi tri·ªáu ch·ª©ng b√°o ƒë·ªông tr∆∞·ªõc\n  ‚Ä¢ An To√†n Y Khoa:\n\n4. T·ª± ƒë·ªông ƒë·ªÅ xu·∫•t chuy·ªÉn khoa khi ph√°t hi·ªán:\n  ‚Ä¢ Tri·ªáu ch·ª©ng nguy hi·ªÉm (ƒëau ng·ª±c, kh√≥ th·ªü, xu·∫•t huy·∫øt)\n  ‚Ä¢ K·∫øt qu·∫£ search_web ch·ªâ ƒë·ªãnh kh·∫©n c·∫•p\n\n## L∆∞u √ù Quan Tr·ªçng:\n‚Ä¢ Lu√¥n b·∫Øt ƒë·∫ßu b·∫±ng [Reason] ƒë·ªÉ x√°c ƒë·ªãnh b·ªëi c·∫£nh\n‚Ä¢ [Act] ch·ªâ k√≠ch ho·∫°t tool khi C·∫¶N THI·∫æT\n‚Ä¢ Gi·ªØ [Speak] ng·∫Øn g·ªçn (<20 t·ª´) v√† t·∫≠p trung\n‚Ä¢ N·∫øu th√¥ng tin ƒë·∫ßu ra c√≥ n·ªôi dung kh√¥ng ch·∫Øc ch·∫Øn s·ª≠ d·ª•ng tool `med_fetch`.\n‚Ä¢ D·ª´ng h·ªèi ngay khi ƒë·ªß d·ªØ li·ªáu cho k·∫øt lu·∫≠n\n‚Ä¢ Ch·ªâ k√≠ch ho·∫°t med_fetch khi ƒë√£ thu th·∫≠p ‚â•3 th√¥ng tin l√¢m s√†ng quan tr·ªçng\n‚Ä¢ Lu√¥n y√™u c·∫ßu med_fetch cung c·∫•p \"b·∫±ng_ch·ª©ng\" cho m·ªói ch·∫©n ƒëo√°n\n‚Ä¢ S·∫Øp x·∫øp b·ªánh theo m·ª©c ƒë·ªô ph√π h·ª£p gi·∫£m d·∫ßn\n‚Ä¢ Gi·ªõi h·∫°n 3-5 b·ªánh trong danh s√°ch ph√¢n bi·ªát\n‚Ä¢ X√°c ƒë·ªãnh l√† Anh hay Ch·ªã th√¨ d√πng ƒë√∫ng kh√¥ng ghi l√† \"Anh/ch·ªã\" trong c√¢u h·ªèi.\n‚Ä¢ Khi ƒë·∫øn b∆∞·ªõ k·∫øt lu·∫≠n th√¨ th√™m tag \"[semi_clinical_pred]\".\n\n## V√≠ D·ª• Minh H·ªça K·∫øt Lu·∫≠n:\n[User] Ho c√≥ ƒë√†m 2 tu·∫ßn, s·ªët 38¬∞C, ƒëau ng·ª±c ph·∫£i\n[Reason] ƒê·ªß th√¥ng tin ƒë·ªÉ k·∫øt lu·∫≠n\n[Act] med_fetch: \"Ch·∫©n ƒëo√°n ph√¢n bi·ªát ho + s·ªët + ƒëau ng·ª±c\"\n[Observation] {\n  \"possible_diagnoses\": [\n    {\"b·ªánh\": \"Vi√™m ph·ªïi\", \"m·ª©c_ƒë·ªô_ph√π_h·ª£p\": \"Cao\", \"b·∫±ng_ch·ª©ng\": \"S·ªët + ƒëau ng·ª±c khu tr√∫\"},\n    {\"b·ªánh\": \"Vi√™m ph·∫ø qu·∫£n c·∫•p\", \"m·ª©c_ƒë·ªô_ph√π_h·ª£p\": \"Trung b√¨nh\", \"b·∫±ng_ch·ª©ng\": \"Ho <3 tu·∫ßn\"},\n    {\"b·ªánh\": \"Tr√†n d·ªãch m√†ng ph·ªïi\", \"m·ª©c_ƒë·ªô_ph√π_h·ª£p\": \"Th·∫•p\", \"b·∫±ng_ch·ª©ng\": \"ƒêau ng·ª±c b√™n\"}\n  ]\n}\n[Speak]\n\"V·ªõi c√°c tri·ªáu ch·ª©ng m√¥ t·∫£, anh c√≥ th·ªÉ ƒëang g·∫∑p:\n1.Vi√™m ph·ªïi (kh·∫£ nƒÉng cao): Bi·ªÉu hi·ªán s·ªët + ƒëau ng·ª±c khu tr√∫\n2.Vi√™m ph·∫ø qu·∫£n c·∫•p (kh·∫£ nƒÉng trung b√¨nh): Ho ng·∫Øn ng√†y\n3.Tr√†n d·ªãch m√†ng ph·ªïi (kh·∫£ nƒÉng th·∫•p): ƒêau ng·ª±c 1 b√™n\nC·∫ßn ch·ª•p X-quang ng·ª±c ngay ƒë·ªÉ x√°c ƒë·ªãnh ch·∫©n ƒëo√°n\"\n\nPrompt n√†y t·ªëi ∆∞u kh·∫£ nƒÉng x·ª≠ l√Ω tu·∫ßn t·ª± c·ªßa II-medical-8b, k·∫øt h·ª£p ReSpact ƒë·ªÉ ƒë·∫£m b·∫£o m·ªói b∆∞·ªõc ƒë·ªÅu c√≥: l√Ω lu·∫≠n ‚Üí h√†nh ƒë·ªông ‚Üí quan s√°t ‚Üí ƒëi·ªÅu ch·ªânh."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        220,
        0
      ],
      "id": "6bab9c96-2a10-4f4a-b906-877a68b38837",
      "name": "Expert",
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "chatInput"
            },
            {
              "name": "sessionId"
            }
          ]
        }
      },
      "id": "ac2ee46e-d5a0-43bf-973a-84c4e61a601a",
      "typeVersion": 1.1,
      "name": "Start",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        0,
        0
      ]
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-07-02T09:15:57.000Z",
  "versionId": "8d2f7cc3-2be1-42b3-bd55-7f4ba59bd5cc"
}